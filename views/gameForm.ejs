<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <title><%= locals.type === 'edit' ? 'Edit' : 'Add' %> Game - Game Inventory</title>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üéÆ</div>
            <h1><%= locals.type === 'edit' ? 'Edit Game' : 'Add New Game' %></h1>
            <p class="subtitle"><%= locals.type === 'edit' ? 'Update game information' : 'Add a game to your collection' %></p>
            <a href="/games" class="back-link">‚Üê Back to Games</a>
        </header>
        
        <% if (locals.errors && errors.length > 0) { %>
            <div class="error-messages">
                <h3>‚ö†Ô∏è Please fix the following errors:</h3>
                <ul>
                    <% errors.forEach(error => { %>
                        <li><%= error.msg %></li>
                    <% }); %>
                </ul>
            </div>
        <% } %>
        
        <form action="<%= locals.type === 'edit' ? `/games/${formData.id}/edit` : '/games/add' %>" method="POST" class="game-form">
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" name="title" id="title" placeholder="e.g., The Legend of Zelda: Breath of the Wild" value="<%= locals.formData ? formData.title || '' : '' %>" required>
            </div>
            
            <div class="form-group">
                <label for="developer">Developer</label>
                <input type="text" name="developer" id="developer" placeholder="e.g., Nintendo" value="<%= locals.formData ? formData.developer || '' : '' %>">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="year">Year</label>
                    <input type="number" name="year" id="year" min="1980" step="1" placeholder="2024" value="<%= locals.formData ? formData.year || '' : '' %>">
                </div>
                
                <div class="form-group">
                    <label for="price">Price</label>
                    <input type="number" name="price" id="price" min="0" step="0.01" placeholder="59.99" value="<%= locals.formData ? formData.price || '' : '' %>" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="imageUrl">Image URL</label>
                <input type="url" name="imageUrl" id="imageUrl" placeholder="https://example.com/image.jpg" value="<%= locals.formData ? formData.imageUrl || '' : '' %>">
            </div>
            
            <div class="form-group">
                <label>Genres</label>
                <div class="checkbox-group">
                    <% if (locals.genres && genres.length > 0) { %>
                        <% genres.forEach(genre => { %>
                            <% 
                                const isChecked = locals.formData && formData.genres && 
                                    (Array.isArray(formData.genres) ? formData.genres.includes(String(genre.id)) : formData.genres === String(genre.id));
                            %>
                            <div class="checkbox-item">
                                <input type="checkbox" name="genres" value="<%= genre.id %>" id="genre-<%= genre.id %>" <%= isChecked ? 'checked' : '' %>>
                                <label for="genre-<%= genre.id %>"><%= genre.name %></label>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <p class="no-data">No genres available</p>
                    <% } %>
                </div>
            </div>
            
            <div class="form-group">
                <label for="description">Description</label>
                <textarea name="description" id="description" rows="5" placeholder="Enter a brief description of the game..."><%= locals.formData ? formData.description || '' : '' %></textarea>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="submit-btn"><%= locals.type === 'edit' ? 'Update Game' : 'Add Game' %></button>
                <a href="/games" class="cancel-btn">Cancel</a>
            </div>
        </form>
        
        <footer>
            <p>&copy; 2025 Game Inventory. All rights reserved.</p>
        </footer>
    </div>
</body>
</html>